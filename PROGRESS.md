# Kurisu é¡¹ç›®è¿›åº¦è¿½è¸ª

> æœ€åæ›´æ–°: 2026-02-22
> çŠ¶æ€: MVP å®Œæˆï¼Œè§’è‰²çµé­‚ç³»ç»Ÿå®Œæˆï¼ŒL6+L7 å·¥å…·å±‚å¼€å‘ä¸­

---

## ğŸ¯ é¡¹ç›®å®šä½

> **"ç”¨æˆ·åªéœ€åˆ›å»ºè§’è‰²ï¼Œå°±èƒ½å¾—åˆ°èƒ½èŠå¤©è¯­éŸ³è§†é¢‘ + èƒ½ç”¨å·¥å…·æ“æ§ç”µè„‘çš„ä¸ªäººåŠ©æ‰‹"**

### æ ¸å¿ƒèƒ½åŠ›ç›®æ ‡

| èƒ½åŠ› | ç›®æ ‡ä½“éªŒ | çŠ¶æ€ |
|------|---------|------|
| **å¯¹è¯çœŸå®æ„Ÿ** | ç”¨æˆ·æ„Ÿå—åˆ°çš„æ˜¯çœŸæ­£çš„è§’è‰² | Phase D å¾…å¼€å‘ |
| **è¯­éŸ³å¯¹è¯** | è§’è‰²ä¸“å±å£°éŸ³ï¼Œå®æ—¶è¯­éŸ³äº¤æµ | Phase A å¾…å¼€å‘ |
| **è§†é¢‘å½¢è±¡** | Live2D è™šæ‹Ÿå½¢è±¡ï¼Œå¯ç›´æ’­ | Phase F å¾…å¼€å‘ |
| **å·¥å…·ä½¿ç”¨** | èƒ½æœç´¢ã€å†™ä»£ç ã€æ“æ§ç”µè„‘ | **Phase B å¼€å‘ä¸­ â† å½“å‰** |
| **é›¶é—¨æ§›å…¥å£** | åˆ›å»ºè§’è‰² = å®Œæ•´åŠ©æ‰‹ | Phase C å¾…å¼€å‘ |

---

## ğŸ“Š æ•´ä½“è¿›åº¦

```
MVP é˜¶æ®µ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
  â”œâ”€â”€ L1 Gateway       âœ…
  â”œâ”€â”€ L2 Persona 1.0   âœ…
  â”œâ”€â”€ L3 Agent         âœ…
  â”œâ”€â”€ L4 Memory        âœ…
  â””â”€â”€ L5 Infrastructureâœ…

Telegram æ¥å…¥ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 80% (KURISU-013)
  â”œâ”€â”€ Phase 0-2.2 æ–‡å­—å¯¹è¯  âœ… ç«¯åˆ°ç«¯æµ‹è¯•é€šè¿‡
  â””â”€â”€ Phase 3 è¯­éŸ³æ¶ˆæ¯      ğŸ”² ä¾èµ– Phase A

2.0 æ ¸å¿ƒèƒ½åŠ› â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 50%
  â”œâ”€â”€ Phase A: åŸºç¡€è¯­éŸ³     ğŸ”² P0
  â”œâ”€â”€ Phase B: å·¥å…·æ²™ç®±     ğŸ”„ å¼€å‘ä¸­ â† å½“å‰ï¼ˆKURISU-016+017 Phase 4 å®Œæˆï¼‰
  â”œâ”€â”€ Phase C: è§’è‰²åˆ›å»ºå‘å¯¼ ğŸ”² P0
  â”œâ”€â”€ Phase D: Persona 2.0  ğŸ”² P1
  â”œâ”€â”€ Phase E: å®æ—¶è¯­éŸ³     ğŸ”² P1
  â”œâ”€â”€ Phase F: è™šæ‹Ÿå½¢è±¡     ğŸ”² P2
  â””â”€â”€ Phase G: è‡ªè¿›åŒ–       ğŸ”² P2
```

---

## æœ€è¿‘å®Œæˆ

### KURISU-016+017 Phase 4: å®¡æ‰¹æµç¨‹é›†æˆï¼ˆ2026-02-22ï¼‰

**ç›®æ ‡**: confirm çº§å·¥å…·éœ€è¦ç”¨æˆ·å®¡æ‰¹ï¼Œå®¡æ‰¹æµç¨‹å®Œæ•´é›†æˆåˆ° Channel å±‚

**å®Œæˆ**:
- âœ… ç±»å‹æ‰©å±•ï¼šAgentResult/StreamResult/GatewayStreamResult æ·»åŠ å®¡æ‰¹å­—æ®µ
  - `approvalRequired`: æ˜¯å¦éœ€è¦å®¡æ‰¹
  - `approvalMessage`: å®¡æ‰¹æ¶ˆæ¯ï¼ˆå‘é€ç»™ç”¨æˆ·ï¼‰
  - `pendingToolCall`: å¾…å®¡æ‰¹çš„å·¥å…·è°ƒç”¨
- âœ… Gateway é›†æˆ ApprovalManager
  - `hasPendingApproval(sessionId)`: æ£€æŸ¥æ˜¯å¦æœ‰å¾…å®¡æ‰¹
  - `checkApprovalReply(sessionId, userMessage)`: æ£€æŸ¥ç”¨æˆ·å›å¤æ˜¯å¦æ˜¯å®¡æ‰¹æŒ‡ä»¤
  - `executeApprovedTool(sessionId, toolCall)`: æ‰§è¡Œå·²æ‰¹å‡†çš„å·¥å…·
- âœ… Orchestrator æš´éœ²å®¡æ‰¹çŠ¶æ€
  - `process()` è¿”å› `approvalRequired/approvalMessage/pendingToolCall`
  - æ–°å¢ `executeTool(sessionId, toolCall)` æ–¹æ³•
- âœ… TelegramChannel å®¡æ‰¹å¤„ç†
  - `handleApprovalReply()`: å¤„ç† approved/rejected/timeout
  - ç”¨æˆ·å›å¤ã€Œç¡®è®¤ã€â†’ æ‰§è¡Œå·¥å…·å¹¶å‘é€ç»“æœ
  - ç”¨æˆ·å›å¤ã€Œå–æ¶ˆã€â†’ å‘é€"å·²å–æ¶ˆæ“ä½œ"
  - è¶…æ—¶ â†’ å‘é€"å®¡æ‰¹å·²è¶…æ—¶"
- âœ… QQChannel å®¡æ‰¹å¤„ç†ï¼ˆåŒä¸Šï¼‰
- âœ… æµ‹è¯•ä¿®å¤ï¼šMock Gateway æ·»åŠ æ–°æ–¹æ³•ï¼Œ298 tests é€šè¿‡

**å®¡æ‰¹æµç¨‹æ¶æ„**:
```
confirm çº§å·¥å…·è°ƒç”¨
    â†“
Orchestrator.process() è¿”å› approvalRequired=true + approvalMessage
    â†“
Channel å‘é€å®¡æ‰¹æ¶ˆæ¯ç»™ç”¨æˆ·ï¼ˆTelegram/QQï¼‰
    â†“
ç”¨æˆ·å›å¤ã€Œç¡®è®¤ã€/ã€Œå–æ¶ˆã€
    â†“
Channel.handleRequest() â†’ Gateway.checkApprovalReply()
    â†“
approved â†’ executeApprovedTool() â†’ å‘é€å·¥å…·æ‰§è¡Œç»“æœ
rejected â†’ å‘é€"å·²å–æ¶ˆæ“ä½œ"
```

### KURISU-016+017 Phase 3: Docker æ²™ç®±ï¼ˆ2026-02-22ï¼‰

**ç›®æ ‡**: confirm çº§å·¥å…·åœ¨ Docker æ²™ç®±ä¸­å®‰å…¨æ‰§è¡Œ

**å®Œæˆ**:
- âœ… `Dockerfile.sandbox` - æœ€å°åŒ– Alpine é•œåƒï¼Œé root ç”¨æˆ·ï¼Œå®‰å…¨é™åˆ¶
- âœ… `SandboxExecutor` (src/tools/sandbox.ts) - Docker å®¹å™¨æ‰§è¡Œå™¨
  - èµ„æºé™åˆ¶ï¼ˆCPUã€å†…å­˜ï¼‰
  - ç½‘ç»œéš”ç¦»
  - åªè¯»æ ¹æ–‡ä»¶ç³»ç»Ÿ
  - è¶…æ—¶å¤„ç†
- âœ… `config/system/sandbox.yaml` - æ²™ç®±é…ç½®æ–‡ä»¶
- âœ… `ToolRegistry.execute()` é›†æˆæ²™ç®±æ‰§è¡Œ
- âœ… å•å…ƒæµ‹è¯•ï¼ˆ10 testsï¼‰

**æ¶æ„**:
```
confirm çº§å·¥å…· â†’ shouldUseSandbox â†’ SandboxExecutor.execute()
                                       â†“
                                  Docker å®¹å™¨ï¼ˆéš”ç¦»ç½‘ç»œ + èµ„æºé™åˆ¶ï¼‰
```

### MCP Bridge CI ä¿®å¤ï¼ˆ2026-02-22ï¼‰

**é—®é¢˜**: ESLint æŠ¥ 5 ä¸ª error å¯¼è‡´ CI å¤±è´¥

**ä¿®å¤**:
- ä½¿ç”¨ MCP SDK å®˜æ–¹ schema (`ListToolsResultSchema`, `CompatibilityCallToolResultSchema`)
- æ­£ç¡®å¤„ç† union ç±»å‹ `CompatibilityCallToolResult` çš„ç±»å‹æ–­è¨€
- æ·»åŠ  eslint-disable æ³¨é‡Šå¤„ç† MCP SDK å¤æ‚ç±»å‹çš„ unsafe æ“ä½œ
- `ToolRegistry`: ç§»é™¤ä¸å¿…è¦çš„éç©ºæ–­è¨€

**ç»“æœ**: CI å…¨éƒ¨é€šè¿‡ (build âœ“, docker âœ“, security âœ“)

### Agent å±‚ function calling é›†æˆï¼ˆ2026-02-22ï¼‰

**Phase 2 å®Œæˆ** âœ…

- æ¨¡å‹å±‚ç±»å‹å®šä¹‰ï¼šOpenAIToolDefinitionã€LLMToolCallã€Message è”åˆç±»å‹
- OpenAI å…¼å®¹ Provider æ”¯æŒ tools å‚æ•°å’Œ tool_calls å“åº”è§£æ
- Agent å±‚ ToolRegistryLike æ¥å£æŠ½è±¡
- generate èŠ‚ç‚¹æ”¯æŒå·¥å…·è°ƒç”¨ç»“æœæ„å»ºå’Œ pendingToolCalls è¿”å›
- æ–°å¢ generateRouterã€toolCallRouter è·¯ç”±
- å·¥ä½œæµå®ç° ReAct å¾ªç¯ï¼šgenerate â†’ tool_call â†’ generateï¼ˆæœ€å¤§ 5 æ¬¡è¿­ä»£ï¼‰

**æ¶æ„å›¾**:
```
conversation/task â†’ generateRouter â†’ tool_call (å¦‚æœæœ‰ tool_calls)
                                       â†“
                              toolCallRouter â†’ conversation/task (ç»§ç»­ç”Ÿæˆ)
                                              â†’ validate (å®Œæˆæˆ–è¶…è¿‡è¿­ä»£ä¸Šé™)
```

### KURISU-016+017: å·¥å…·æ‰§è¡Œå±‚ + Skill Systemï¼ˆ2026-02-22ï¼‰

> è¯¦ç»†æ–‡æ¡£: `.claude/tasks/KURISU-016-017-TOOL-SKILL-SYSTEM.md`

**Phase 1 å®Œæˆ** âœ…
- å·¥å…·ç±»å‹å®šä¹‰ (ToolDef, ToolCall, ToolResult, PermissionLevel)
- Skill ç±»å‹å®šä¹‰ (SkillConfig, TriggerRule)
- æ‰©å±• AgentState æ·»åŠ å·¥å…·ç›¸å…³å­—æ®µ
- skill_activate èŠ‚ç‚¹ + workflow é›†æˆ

**Phase 2 å®Œæˆ** âœ…
- âœ… MCP SDK é›†æˆ (@modelcontextprotocol/sdk + dockerode)
- âœ… MCPBridge: MCP å®¢æˆ·ç«¯è¿æ¥æ± 
- âœ… ToolRegistry: å·¥å…·æ³¨å†Œè¡¨ + OpenAI æ ¼å¼è½¬æ¢
- âœ… PermissionChecker: safe/confirm/deny ä¸‰çº§æƒé™
- âœ… ApprovalManager: å®¡æ‰¹æµç¨‹ç®¡ç†
- âœ… tool_call èŠ‚ç‚¹
- âœ… generate èŠ‚ç‚¹æ”¯æŒ tools å‚æ•°
- âœ… ReAct å¾ªç¯é›†æˆï¼ˆgenerate â†’ tool_call â†’ generateï¼Œæœ€å¤§ 5 æ¬¡è¿­ä»£ï¼‰
- âœ… OpenAI-compatible Provider æ”¯æŒ function calling
- âœ… æ–°å¢ generateRouterã€toolCallRouter è·¯ç”±

**Phase 4 å®Œæˆ** âœ… (2026-02-22)
- âœ… ç±»å‹æ‰©å±•ï¼šAgentResult/StreamResult/GatewayStreamResult æ·»åŠ å®¡æ‰¹å­—æ®µ
- âœ… Gateway é›†æˆ ApprovalManagerï¼šhasPendingApproval, checkApprovalReply, executeApprovedTool
- âœ… Orchestrator æš´éœ²å®¡æ‰¹çŠ¶æ€ï¼šprocess() è¿”å› approvalRequired/approvalMessage/pendingToolCall
- âœ… Orchestrator æ·»åŠ  executeTool() æ–¹æ³•ï¼šæ‰§è¡Œå·²æ‰¹å‡†çš„å·¥å…·
- âœ… TelegramChannel å®¡æ‰¹å¤„ç†ï¼šhandleApprovalReply æ–¹æ³•å¤„ç†ç¡®è®¤/å–æ¶ˆ/è¶…æ—¶
- âœ… QQChannel å®¡æ‰¹å¤„ç†ï¼šhandleApprovalReply æ–¹æ³•å¤„ç†ç¡®è®¤/å–æ¶ˆ/è¶…æ—¶
- âœ… æµ‹è¯•ä¿®å¤ï¼šMock Gateway æ·»åŠ  checkApprovalReply + executeApprovedTool

**å®¡æ‰¹æµç¨‹æ¶æ„**:
```
confirm çº§å·¥å…· â†’ Orchestrator è¿”å› approvalRequired + approvalMessage
                          â†“
                    Channel å‘é€å®¡æ‰¹æ¶ˆæ¯ç»™ç”¨æˆ·
                          â†“
ç”¨æˆ·å›å¤ã€Œç¡®è®¤ã€/ã€Œå–æ¶ˆã€ â†’ Gateway.checkApprovalReply()
                          â†“
                    approved/rejected/timeout
                          â†“
           approved â†’ Gateway.executeApprovedTool() â†’ å‘é€ç»“æœ
```

**å¾…å®Œæˆ**
- Phase 5: Skill Loader/Registry å®ç°
- Phase 6: äººè®¾åŒ–åŒ…è£… + å•å…ƒæµ‹è¯•

### è§’è‰²çµé­‚ç³»ç»Ÿä¼˜åŒ–ï¼ˆ2026-02-21ï¼‰

å‚è€ƒ OpenClaw SOUL.md è¡Œä¸ºå¯†åº¦åŸåˆ™ï¼Œä¼˜åŒ–è§’è‰²é…ç½®æ–‡ä»¶ï¼š

- **soul.md** ç²¾ç®€ 74%ï¼ˆ1600è¯ â†’ 420è¯ï¼‰ï¼Œåˆ é™¤å™äº‹å¡«å……ï¼Œä¿ç•™è¡Œä¸ºå¯†åº¦
  - æ–°å¢"å…ˆè¡ŒåŠ¨ï¼Œå†å¼€å£"åŸåˆ™ â€” è§£å†³æ‹’ç»ä½¿ç”¨å·¥å…·çš„é—®é¢˜
  - è§£é‡Š"å“¼"æ˜¯æƒ…ç»ªé˜²å¾¡éå¼€åœºç™½ â€” è§£å†³å‚²å¨‡æ³›æ»¥é—®é¢˜
- **persona.yaml** æ‹†åˆ† when_refusing ä¸ºä¸‰ç±»ï¼Œæ–°å¢ when_using_toolsï¼Œç§»é™¤ max_sentences ç¡¬é™åˆ¶
- **prompt-builder.ts** åˆ é™¤å¤–éƒ¨å­—æ•°è§„åˆ™ï¼ˆç”±çµé­‚å†…åœ¨åŠ¨æœºé©±åŠ¨ç®€æ´æ€§ï¼‰
- **ROLE-SOUL-SPEC.md** å‡è‡³ v1.1ï¼Œè¡¥å…… OpenClaw è¡Œä¸ºå¯†åº¦åŸåˆ™

---

## å½“å‰ä»»åŠ¡

### KURISU-015: åŸºç¡€è¯­éŸ³èƒ½åŠ› [P0] â† ä¸‹ä¸€æ­¥

> è¯¦ç»†æ–‡æ¡£: å¾…åˆ›å»º `docs/tasks/active/KURISU-015-VOICE-BASIC.md`

**çŠ¶æ€**: å¾…å¯åŠ¨

| ä»»åŠ¡ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| Whisper STT é›†æˆ | ğŸ”² | æœ¬åœ°è¯­éŸ³è¯†åˆ«ï¼Œæ¥æ”¶ Telegram è¯­éŸ³æ¶ˆæ¯ |
| Fish Audio TTS é›†æˆ | ğŸ”² | API è¯­éŸ³åˆæˆï¼Œåˆæˆè§’è‰²å£°éŸ³ |
| Telegram è¯­éŸ³æ¶ˆæ¯æ”¶å‘ | ğŸ”² | æ¥æ”¶è¯­éŸ³ â†’ STT â†’ å¤„ç† â†’ TTS â†’ å‘é€ |
| æµå¼ TTS è¾“å‡º | ğŸ”² | è¾¹ç”Ÿæˆè¾¹æ’­æ”¾ï¼Œé™ä½å»¶è¿Ÿ |
| è§’è‰²éŸ³è‰²é…ç½® | ğŸ”² | role.yaml ä¸­ voice å­—æ®µ |

---

### KURISU-016: å·¥å…·æ‰§è¡Œæ²™ç®± [P0] â† å¯ä¸ 015 å¹¶è¡Œ

> è¯¦ç»†æ–‡æ¡£: å¾…åˆ›å»º `docs/tasks/active/KURISU-016-TOOL-SANDBOX.md`

**çŠ¶æ€**: å¾…å¯åŠ¨

| ä»»åŠ¡ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| Docker å·¥å…·æ²™ç®±è®¾è®¡ | ğŸ”² | éš”ç¦»æ‰§è¡Œç¯å¢ƒ |
| å·¥å…·æƒé™åˆ†çº§ç³»ç»Ÿ | ğŸ”² | å®‰å…¨/ç¡®è®¤/ç¦æ­¢ä¸‰çº§ |
| å†…ç½®å·¥å…·: web_search | ğŸ”² | æœç´¢ç½‘é¡µ |
| å†…ç½®å·¥å…·: file_read | ğŸ”² | è¯»å–æ–‡ä»¶ |
| å†…ç½®å·¥å…·: screenshot | ğŸ”² | æˆªå›¾+ç†è§£ |
| å†…ç½®å·¥å…·: browser | ğŸ”² | Playwright æµè§ˆå™¨æ§åˆ¶ |
| å†…ç½®å·¥å…·: shell | ğŸ”² | æ²™ç®±å†… Shell æ‰§è¡Œ |
| å·¥å…·è¾“å‡ºäººè®¾åŒ–åŒ…è£… | ğŸ”² | PersonaEngine.wrapToolOutput() |

---

### KURISU-017: è§’è‰²åˆ›å»ºå‘å¯¼ + Skill System [P0]

> è¯¦ç»†æ–‡æ¡£: `.claude/tasks/KURISU-017-ROLE-WIZARD-SKILL.md` âœ… å·²åˆ›å»º

**çŠ¶æ€**: å¾…å¯åŠ¨ï¼ˆä¾èµ– 015 å’Œ 016 å®Œæˆï¼‰

**Phase 1: Skill Systemï¼ˆä¼˜å…ˆï¼‰**

| ä»»åŠ¡ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| Skill ç±»å‹å®šä¹‰ï¼ˆtypes.tsï¼‰ | ğŸ”² | SkillConfig, TriggerRule |
| skill.yaml è§£æå™¨ | ğŸ”² | åŠ è½½å¹¶éªŒè¯ YAML |
| SkillRegistry å®ç° | ğŸ”² | æ³¨å†Œ/æŸ¥è¯¢/æ„å›¾åŒ¹é… |
| çŸ¥è¯†æ³¨å…¥åˆ° Prompt | ğŸ”² | context + examples æ³¨å…¥ System Prompt |
| coding-assistant å†…ç½® Skill | ğŸ”² | ç¬¬ä¸€ä¸ª Skillï¼ŒéªŒè¯è®¾è®¡ |

**Phase 2: åˆ›å»ºå‘å¯¼**

| ä»»åŠ¡ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| role.yaml æ ¼å¼å®šä¹‰ï¼ˆå« skills å­—æ®µï¼‰ | ğŸ”² | è§’è‰²é…ç½®åŒ…å« Skill ç»‘å®š |
| 5æ­¥åˆ›å»ºå‘å¯¼ CLI | ğŸ”² | Step 4 = Skill é€‰æ‹© |
| Kurisu å†…ç½®æ¨¡æ¿ | ğŸ”² | åŒ…å«é»˜è®¤ Skills |

**Phase 3: Skill Store CLI**

| ä»»åŠ¡ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| kurisu skill list/install/remove | ğŸ”² | åƒ npm ä¸€æ ·ç®¡ç† Skill |

---

### KURISU-014 é‡æ–°è§„åˆ’ï¼šPersona Engine 2.0 [P1]

> çŠ¶æ€: Phase A/B/C å®Œæˆåå¯åŠ¨

| ä»»åŠ¡ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| è§’è‰²çŸ¥è¯†åº“ YAML æ ¼å¼ | ğŸ”² | config/personas/kurisu/ |
| 10+ å¯¹è¯ç¤ºä¾‹ç¼–å†™ | ğŸ”² | Few-Shot å­¦ä¹ åŸºç¡€ |
| Few-Shot æ³¨å…¥æœºåˆ¶ | ğŸ”² | åŠ¨æ€åŒ¹é… + Prompt æ³¨å…¥ |
| æƒ…æ„ŸçŠ¶æ€è¿½è¸ª | ğŸ”² | å½±å“ TTS è¯­è°ƒ + Live2D è¡¨æƒ… |

---

## å¹¶è¡Œä»»åŠ¡

### KURISU-013: å¤šå¹³å°æ¥å…¥

**çŠ¶æ€**: QQ Channel Reverse HTTP æ¨¡å¼å®Œæˆ (2026-02-21)

| Phase | çŠ¶æ€ | è¯´æ˜ |
|-------|------|------|
| Telegram æ–‡å­— | âœ… | ç«¯åˆ°ç«¯é€šè¿‡ (2026-02-19) |
| **QQ æ–‡å­—** | âœ… **å®Œæˆ** | Reverse HTTP æ¨¡å¼ + 19 tests (2026-02-21) |
| QQ ç«¯åˆ°ç«¯ | ğŸ”„ **æµ‹è¯•ä¸­** | NapCat å·²é…ç½®ï¼Œå¾…éªŒè¯æ¶ˆæ¯æ”¶å‘ |
| QQ è¯­éŸ³ | ğŸ”² | ä¾èµ– KURISU-015 å®Œæˆ |
| Telegram è¯­éŸ³ | ğŸ”² æš‚ç¼“ | ä¾èµ– KURISU-015 å®Œæˆ |
| Discord è¯­éŸ³ | ğŸ”² å»¶å | ä¾èµ– Phase E |

**æŠ€æœ¯è¦ç‚¹**:
- NapCat ä¸æ”¯æŒ `get_latest_events` Pollingï¼Œæ”¹ç”¨ Reverse HTTP
- NapCat ä½¿ç”¨ `send_private_msg`/`send_group_msg` è€Œé `send_message`
- é…ç½®ï¼šHTTP Server (3001) + HTTP Client (æ¨é€äº‹ä»¶åˆ° Kurisu)

### å¯åŠ¨æ–¹å¼å˜åŒ–

```bash
# ä»¥å‰ï¼ˆä¸¤ä¸ªç»ˆç«¯ï¼‰
# terminal 1: cloudflared tunnel --url http://localhost:3000
# terminal 2: pnpm dev æˆ– docker compose up

# ç°åœ¨ï¼ˆä¸€æ¡å‘½ä»¤ï¼‰
docker compose --profile qq up       # QQ æµ‹è¯•ï¼Œæ— éœ€ Tunnel
docker compose --profile tunnel up   # Telegram Webhook æ¨¡å¼
```

---

## å·²å®Œæˆæ¨¡å—

### MVP æ ¸å¿ƒåŠŸèƒ½ âœ…

| å±‚çº§ | æ¨¡å— | æµ‹è¯•æ•° | è¦†ç›–ç‡ |
|------|------|--------|--------|
| L1 | äº¤äº’ç½‘å…³ | 264 | 98%+ |
| L2 | äººè®¾å¼•æ“ 1.0 | 288 | - |
| L3 | Agent ç¼–æ’ | 21 | - |
| L4 | è®°å¿†ç³»ç»Ÿ | 184 | - |
| E2E | ç«¯åˆ°ç«¯æµ‹è¯• | 67 | - |
| L5 | åŸºç¡€è®¾æ–½ | - | - |
| **æ–°å¢** | **è§’è‰²çµé­‚ç³»ç»Ÿ** | **34** | **-** |

**æ€»è®¡**: 963 tests, 83%+ coverage

### CI ä¿®å¤ (2026-02-21)

- ä¿®å¤ TypeScript ç±»å‹æ£€æŸ¥é”™è¯¯ï¼šç§»é™¤æœªä½¿ç”¨çš„ç±»å‹å¯¼å…¥
- é€‚é…ä¸‰å±‚æ¶æ„æµ‹è¯•ï¼šæ‰€æœ‰æµ‹è¯•åœ¨è°ƒç”¨ä¾èµ– roleConfig çš„æ–¹æ³•å‰å…ˆåŠ è½½è§’è‰²
- ä¿®å¤ `PersonaEngine.updateMentalModel()` ä¿ç•™ roleConfig çš„ bug

### çµé­‚ç³»ç»ŸåŠ è½½ä¿®å¤ (2026-02-21)

- **å…³é”® Bug**ï¼šserver.ts æœªè°ƒç”¨ `loadRole()`ï¼Œçµé­‚ç³»ç»Ÿæ ¹æœ¬æ²¡æœ‰åŠ è½½
- ä¿®å¤ï¼šæ·»åŠ  `await personaEngine.loadRole(defaultRole)`
- CLI é‡æ„ä¸ºé™æ€å·¥å‚æ–¹æ³• `KurisuCLI.create()`
- æ¶ˆé™¤ç¡¬ç¼–ç ï¼š`defaults.role` ä»é…ç½®è¯»å–
- soul.md æ–°å¢"æˆ‘è¯´è¯çš„æ–¹å¼"ç« èŠ‚ï¼ˆå†…åœ¨åŠ¨æœºé©±åŠ¨ç®€æ´å›å¤ï¼‰
- persona.yaml ç§»é™¤ `max_sentences: 3` ç¡¬æ€§é™åˆ¶ï¼Œæ”¹ç”¨ `style.brevity`

### è§’è‰²çµé­‚ç³»ç»Ÿ âœ… (2026-02-21)

> è¯¦ç»†è®¾è®¡: `docs/design/ROLE-SOUL-SPEC.md`

ä¸‰å±‚æ¶æ„ï¼ˆT017ï¼‰:
- **L-1 ç³»ç»Ÿå®‰å…¨å±‚**: SilentSafetyInterceptor é™é»˜æ‹¦æˆªï¼Œè¿”å›ç»“æ„åŒ–é”™è¯¯
- **L0 çµé­‚å±‚**: soul.md ç¬¬ä¸€äººç§°å®šä¹‰ï¼ˆä»·å€¼è§‚ã€çŸ›ç›¾ã€æƒ…æ„Ÿæ·±åº¦ï¼‰
- **L1 è¡¨ç°å±‚**: persona.yaml è¯´è¯ä¹ æƒ¯ã€è¡Œä¸ºå€¾å‘ã€æ ¼å¼åŒ–è§„åˆ™

| æ¨¡å— | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| ç±»å‹å®šä¹‰ | soul-types.ts | SoulConfig, PersonaConfig, RoleConfig |
| é…ç½®åŠ è½½ | role-loader.ts | åŠ è½½ soul.md + persona.yaml + lore.md + memories/ |
| å®‰å…¨æ‹¦æˆª | silent-interceptor.ts | é™é»˜è¿”å›ç»“æ„åŒ–é”™è¯¯ï¼Œä¸äº§ç”Ÿå¯¹è¯è¾“å‡º |
| é”™è¯¯è¡¨è¾¾ | response-builder.ts | å°†å®‰å…¨é”™è¯¯è½¬ä¸ºè§’è‰²åŒ–è¡¨è¾¾ |
| Kurisu é…ç½® | config/personas/kurisu/ | å®Œæ•´çµé­‚é…ç½®ï¼ˆsoul.md + persona.yamlï¼‰|

---

## æ¶æ„æ¼”è¿›

### MVP (äº”å±‚) âœ…

```
L1 Gateway â†’ L2 Persona 1.0 â†’ L3 Agent â†’ L4 Memory â†’ L5 Infrastructure
```

### 2.0 ç›®æ ‡ (ä¹å±‚)

```
L1 Gatewayï¼ˆå¤šæ¸ é“ï¼šæ–‡å­—/è¯­éŸ³/è§†é¢‘ï¼‰
    â†“
L2 Multimodalï¼ˆSTT/å›¾åƒç†è§£/å®æ—¶æµï¼‰â­æ–°å¢
    â†“
L3 Persona Engine 2.0ï¼ˆè§’è‰²ä¸€è‡´æ€§+æƒ…æ„ŸçŠ¶æ€ï¼‰
    â†“
L4 Agent Orchestrator
    â†“
L5 Memory Systemï¼ˆ+ç”¨æˆ·ç”»åƒï¼‰
    â†“
L6 Tool Executorï¼ˆDockeræ²™ç®±+æƒé™ç®¡ç†ï¼‰â­é‡è®¾è®¡
    â†“
L7 Self-Evolutionï¼ˆMCPä¼˜å…ˆ+æ’ä»¶å‘ç°ï¼‰
    â†“
L8 Presentationï¼ˆTTS+Live2D+è™šæ‹Ÿæ‘„åƒå¤´ï¼‰â­æ–°å¢
    â†“
L9 Role Configï¼ˆä¸€ç«™å¼åˆ›å»ºå‘å¯¼ï¼‰â­é‡è®¾è®¡
```

---

## æŠ€æœ¯å†³ç­–

| ID | å†³ç­– | æ—¥æœŸ |
|----|------|------|
| T001 | YAML é…ç½® + ç¯å¢ƒå˜é‡æ³¨å…¥ | 2026-02-16 |
| T002 | Anthropic å…¼å®¹ API ä¼˜å…ˆ | 2026-02-16 |
| T003 | GLM-5 API å…ˆè¡Œ | 2026-02-18 |
| T004 | setup.sh å»¶å | 2026-02-18 |
| T005 | å¯¹è¯è´¨é‡ï¼šé™ä½å»¶è¿Ÿ + äººè®¾å¾®è°ƒ | 2026-02-18 |
| T006 | ä¸¤å¤§æ ¸å¿ƒèƒ½åŠ›ï¼šè§’è‰²çœŸå®æ„Ÿ + è‡ªè¿›åŒ– | 2026-02-19 |
| T007 | AstrBot æ’ä»¶æ¡¥æ¥ï¼ŒMCP ä¼˜å…ˆ | 2026-02-19 |
| T008 | å·¥å…·è¾“å‡ºäººè®¾åŒ–åŒ…è£… | 2026-02-19 |
| T009 | ä¹å±‚æ¶æ„ï¼šè¡¥å……å¤šæ¨¡æ€+è¡¨ç°+å·¥å…·æ²™ç®±å±‚ | 2026-02-19 |
| T010 | è·¯çº¿å›¾é‡æ’ï¼šè¯­éŸ³+å·¥å…·æ²™ç®±ä¼˜å…ˆäº Persona 2.0 | 2026-02-19 |
| **T017** | **è§’è‰²çµé­‚ç³»ç»Ÿï¼šå®‰å…¨å±‚(é™é»˜)+çµé­‚å±‚+è¡¨ç°å±‚** | **2026-02-21** |

---

## å…³é”®æ–‡ä»¶

```
kurisu/
â”œâ”€â”€ CLAUDE.md              # é¡¹ç›®è§„èŒƒï¼ˆä¹å±‚æ¶æ„ï¼‰
â”œâ”€â”€ PROGRESS.md            # æœ¬æ–‡ä»¶
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ models.yaml        # æ¨¡å‹é…ç½®
â”‚   â”œâ”€â”€ personas/          # è§’è‰²é…ç½®ç›®å½•ï¼ˆL9ï¼‰
â”‚   â”‚   â””â”€â”€ kurisu/
â”‚   â”‚       â”œâ”€â”€ soul.md        # çµé­‚å±‚ï¼ˆç¬¬ä¸€äººç§°ï¼‰âœ…
â”‚   â”‚       â”œâ”€â”€ persona.yaml   # è¡¨ç°å±‚ï¼ˆè¯´è¯ä¹ æƒ¯ï¼‰âœ…
â”‚   â”‚       â”œâ”€â”€ lore.md        # ä¸–ç•Œè§‚ âœ…
â”‚   â”‚       â””â”€â”€ memories/      # è®°å¿†é…ç½® âœ…
â”‚   â””â”€â”€ system/            # ç³»ç»Ÿé…ç½®
â”‚       â””â”€â”€ safety.yaml        # å®‰å…¨è§„åˆ™ âœ…
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ gateway/           # L1 äº¤äº’ç½‘å…³ âœ…
â”‚   â”œâ”€â”€ multimodal/        # L2 å¤šæ¨¡æ€å¤„ç† ğŸ”² å¾…æ–°å¢
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ persona/       # L3 äººè®¾å¼•æ“ âœ…ï¼ˆå«çµé­‚ç³»ç»Ÿï¼‰
â”‚   â”‚   â””â”€â”€ safety/        # L-1 å®‰å…¨å±‚ âœ… æ–°å¢
â”‚   â”œâ”€â”€ agents/            # L4 Agent ç¼–æ’ âœ…
â”‚   â”œâ”€â”€ memory/            # L5 è®°å¿†ç³»ç»Ÿ âœ…
â”‚   â”œâ”€â”€ tools/             # L6 å·¥å…·æ‰§è¡Œå±‚ ğŸ”² å¾…æ–°å¢
â”‚   â”œâ”€â”€ skills/            # L7 Skill System ğŸ”² å¾…æ–°å¢
â”‚   â””â”€â”€ presentation/      # L8 è¡¨ç°è¾“å‡ºå±‚ ğŸ”² å¾…æ–°å¢
â””â”€â”€ docs/
    â”œâ”€â”€ design/ROLE-SOUL-SPEC.md  # çµé­‚ç³»ç»Ÿè®¾è®¡ âœ…
    â””â”€â”€ tasks/active/             # ä»»åŠ¡æ–‡æ¡£
```

---

## ä¸‹ä¸€æ­¥ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰

### KURISU-016+017 Phase 5-6ï¼ˆç»§ç»­ï¼‰

1. **Phase 5: Skill System** â€” SkillLoader + SkillRegistry + IntentMatcher + KnowledgeInjector
2. **Phase 6: äººè®¾åŒ…è£… + æµ‹è¯•** â€” PersonaWrapper + å•å…ƒæµ‹è¯• 80%+ è¦†ç›–ç‡

### å¯å¹¶è¡Œå¯åŠ¨ï¼ˆP0ï¼‰

3. **KURISU-015** â€” åŸºç¡€è¯­éŸ³ï¼šWhisper STT + Fish Audio TTS + Telegram è¯­éŸ³æ¶ˆæ¯

### 016+017 å®Œæˆå

4. **KURISU-017** â€” è§’è‰²åˆ›å»ºå‘å¯¼ï¼š5æ­¥ CLI å‘å¯¼ + role.yaml æ ¼å¼
